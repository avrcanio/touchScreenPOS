<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="TouchScreenPOS" Language="1033" Version="1.0.0" Manufacturer="MOZART" UpgradeCode="048cf21e-9940-4570-9678-00d01d4e7478">
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Icon Id="launcher.ico" SourceFile="$(var.ProjectDir)Assets\launcher.ico" />
    <Property Id="ARPPRODUCTICON" Value="launcher.ico" />

    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="TouchScreenPOS">
        <Component Id="MainExecutable">
          <File Id="TouchScreenPOSExe" Source="$(var.PublishDir)TouchScreenPOS.exe" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="TouchScreenPOS">
        <Component Id="StartMenuShortcut">
          <Shortcut Id="ApplicationStartMenuShortcut"
                    Name="TouchScreenPOS"
                    Description="TouchScreenPOS"
                    Target="[INSTALLFOLDER]TouchScreenPOS.exe"
                    WorkingDirectory="INSTALLFOLDER"
                    Icon="launcher.ico" />
          <RemoveFolder Id="RemoveApplicationProgramsFolder" On="uninstall" />
          <RegistryValue Root="HKCU" Key="Software\TouchScreenPOS" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="DesktopFolder">
      <Component Id="DesktopShortcut">
        <Shortcut Id="ApplicationDesktopShortcut"
                  Name="TouchScreenPOS"
                  Target="[INSTALLFOLDER]TouchScreenPOS.exe"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="launcher.ico" />
        <RegistryValue Root="HKCU" Key="Software\TouchScreenPOS" Name="desktop" Type="integer" Value="1" KeyPath="yes" />
      </Component>
    </StandardDirectory>

    <Feature Id="ProductFeature" Title="TouchScreenPOS" Level="1">
      <ComponentRef Id="MainExecutable" />
      <ComponentRef Id="StartMenuShortcut" />
      <ComponentRef Id="DesktopShortcut" />
    </Feature>
  </Package>
</Wix>
